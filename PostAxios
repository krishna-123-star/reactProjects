import { useState, type ChangeEvent, type FormEvent } from "react";
import axios from "axios";

function PostAxios() {
  const [postData, setPostData] = useState({
    firstName: "",
    lastName: "",
    email: "",
    gender: "",
    contactNumber: "",
  });

  const token =
    "eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI0MTkyNzNlNi1kOTQzLTQzMzAtODgxNy0yNmMzNDU1NjMwZGUiLCJpYXQiOjE3NTU1MDY1OTEsImV4cCI6MTc1ODA5ODU5MX0.PrsLtSRWVizwwTejhL0zX1KjuRANg63D5FguQ65Z9NdrYgj9As-sI07ZCcynv3m8w49o4HMYDjrp37oFC_3TjA";

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();

    try {
      const formData = new FormData();
      formData.append("firstName", postData.firstName);
      formData.append("lastName", postData.lastName);
      formData.append("email", postData.email);
      formData.append("gender", postData.gender);
      formData.append("contactNumber", postData.contactNumber);

      const response = await axios.post(
        "https://zencura-dev-api.xminds.com/v1/technician",
        formData,
        {
          headers: {
            Authorization: `Bearer ${token}`,
            "Content-Type": "multipart/form-data"
          }
        }
      );

      console.log("Technician created: ", response.data);
    } catch (error) {
      console.error("Error creating technician: ", error);
    }
  };

  const handleChange = (
    e: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>
  ) => {
    const { name, value } = e.target;
    setPostData({
      ...postData,
      [name]: value
    });
  };

  return (
    <div>
      <h2>Create Technician</h2>
      <form onSubmit={handleSubmit}>
        <label>
          First Name:
          <input
            type="text"
            name="firstName"
            value={postData.firstName}
            onChange={handleChange}
          />
        </label>
        <label>
          Last Name:
          <input
            type="text"
            name="lastName"
            value={postData.lastName}
            onChange={handleChange}
          />
        </label>
        <br />
        <label>
          Email:
          <input
            type="email"
            name="email"
            value={postData.email}
            onChange={handleChange}
          />
        </label>
        <br />
        <label>
          Gender:
          <input
            type="text"
            name="gender"
            value={postData.gender}
            onChange={handleChange}
          />
        </label>
        <label>
          Contact Number:
          <input
            type="tel"
            name="contactNumber"
            value={postData.contactNumber}
            onChange={handleChange}
            required
            placeholder="Enter mobile number"
          />
        </label>
        <br />
        <button type="submit">Submit</button>
      </form>
    </div>
  );
}

export default PostAxios;
